
@using System.Security.Claims
@{
     int idnv = int.Parse(User.FindFirstValue(ClaimTypes.Name));
}

<div class="container-xxl flex-grow-1 container-p-y">
    <h2>QR Code Generated</h2>
    <div id="qrCodeContainer" >
        <img id="qrCodeImage" alt="QR Code" />
    </div>
 
</div>

 <script>
var idnv = @Html.Raw(Json.Serialize(idnv));

document.addEventListener("DOMContentLoaded", function () {
    generateQRCode();
     @* setInterval(function() {
        generateQRCode();
        console.log(123);
    }, 60000); *@
});
    function generateQRCode() {
    var currentDate = new Date(); // Lấy ngày giờ hiện tại
    // Lấy các giá trị riêng lẻ của ngày, tháng, năm, giờ, phút
    var day = String(currentDate.getDate()).padStart(2, '0'); // Lấy ngày (có thêm số 0 nếu cần thiết)
    var month = String(currentDate.getMonth() + 1).padStart(2, '0'); // Lấy tháng (có thêm số 0 nếu cần thiết)
    var year = currentDate.getFullYear(); // Lấy năm
    var hours = String(currentDate.getHours()).padStart(2, '0'); // Lấy giờ (có thêm số 0 nếu cần thiết)
    var minutes = String(currentDate.getMinutes()).padStart(2, '0'); // Lấy phút (có thêm số 0 nếu cần thiết)
    var qrText = idnv;// + "_" + day + month + year + hours + minutes;
        $.ajax({
            type: "POST",
            url: "/QRCode/GenerateQRCode",
            data: { qrText: qrText },
            success: function (base64Image) {
                // Hiển thị QR code
                $("#qrCodeContainer").html('<img src="data:image/png;base64,' + base64Image + '" alt="QR Code">');
            }
        });
    }
    </script>